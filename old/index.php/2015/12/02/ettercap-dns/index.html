<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="zh-CN">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="zh-CN">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="zh-CN">
<!--<![endif]-->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11" />
<title>ettercap学习之内网dns劫持 &#8211; 叁公子的博客</title>
<link rel="alternate" type="application/rss+xml" title="叁公子的博客 &raquo; Feed" href="http://nladuo.github.io/old/index.php/feed/" />

<link rel="alternate" type="application/rss+xml" title="叁公子的博客 &raquo; ettercap学习之内网dns劫持评论Feed" href="http://nladuo.github.io/old/index.php/2015/12/02/ettercap-dns/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/nladuo.github.io\/old\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.2"}};
			!function(a,b,c){function d(a){var c,d=b.createElement("canvas"),e=d.getContext&&d.getContext("2d"),f=String.fromCharCode;return e&&e.fillText?(e.textBaseline="top",e.font="600 32px Arial","flag"===a?(e.fillText(f(55356,56806,55356,56826),0,0),d.toDataURL().length>3e3):"diversity"===a?(e.fillText(f(55356,57221),0,0),c=e.getImageData(16,16,1,1).data.toString(),e.fillText(f(55356,57221,55356,57343),0,0),c!==e.getImageData(16,16,1,1).data.toString()):("simple"===a?e.fillText(f(55357,56835),0,0):e.fillText(f(55356,57135),0,0),0!==e.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='crayon-css'  href='http://nladuo.github.io/old/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-sublime-text-css'  href='http://nladuo.github.io/old/wp-content/plugins/crayon-syntax-highlighter/themes/sublime-text/sublime-text.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='http://nladuo.github.io/old/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='spacious_style-css'  href='http://nladuo.github.io/old/wp-content/themes/spacious/style.css?ver=4.4.2' type='text/css' media='all' />
<link rel='stylesheet' id='spacious-genericons-css'  href='http://nladuo.github.io/old/wp-content/themes/spacious/genericons/genericons.css?ver=3.3.1' type='text/css' media='all' />
<link rel='stylesheet' id='google_fonts-css'  href='//fonts.googleapis.com/css?family=Lato&#038;ver=4.4.2' type='text/css' media='all' />
<script type='text/javascript' src='http://nladuo.github.io/old/wp-includes/js/jquery/jquery.js?ver=1.11.3'></script>
<script type='text/javascript' src='http://nladuo.github.io/old/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/nladuo.github.io\/old\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"\u4f7f\u7528 %s \u590d\u5236\uff0c\u4f7f\u7528 %s \u7c98\u8d34\u3002","minimize":"\u70b9\u51fb\u5c55\u5f00\u4ee3\u7801"};
/* ]]> */
</script>
<script type='text/javascript' src='http://nladuo.github.io/old/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript' src='http://nladuo.github.io/old/wp-content/themes/spacious/js/spacious-custom.js?ver=4.4.2'></script>
<link rel='https://api.w.org/' href='http://nladuo.github.io/old/wp-json/' />
<link rel='prev' title='go语言实现模拟登陆极客学院' href='http://nladuo.github.io/old/index.php/2015/11/10/monidenglu/' />
<link rel='next' title='教你DIY一个PM2.5检测仪' href='http://nladuo.github.io/old/index.php/2015/12/09/diy-pm2-5/' />
<meta name="generator" content="WordPress 4.4.2 - really-static 0.5" />
<link rel="canonical" href="http://nladuo.github.io/old/index.php/2015/12/02/ettercap-dns/" />
<link rel="alternate" type="application/json+oembed" href="http://nladuo.github.io/old/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fblog.kalen25115.cn%2Fstatic%2Findex.php%2F2015%2F12%2F02%2Fettercap-dns%2F" />
<link rel="alternate" type="text/xml+oembed" href="http://nladuo.github.io/old/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fblog.kalen25115.cn%2Fstatic%2Findex.php%2F2015%2F12%2F02%2Fettercap-dns%2F&#038;format=xml" />
		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		</head>

<body class="single single-post postid-11 single-format-standard ">
<div id="page" class="hfeed site">
		<header id="masthead" class="site-header clearfix">

		
		<div id="header-text-nav-container">
			<div class="inner-wrap">

				<div id="header-text-nav-wrap" class="clearfix">
					<div id="header-left-section">
												<div id="header-text" class="">
                                       <h3 id="site-title">
                        <a href="http://nladuo.github.io/old/" title="叁公子的博客" rel="home">叁公子的博客</a>
                     </h3>
                                    <!-- #site-description -->
						</div><!-- #header-text -->
					</div><!-- #header-left-section -->
					<div id="header-right-section">
												<nav id="site-navigation" class="main-navigation" role="navigation">
							<h3 class="menu-toggle">Menu</h3>
							<div class="menu"><ul><li class="page_item page-item-16"><a href="http://nladuo.github.io/old/index.php/about/">关于我</a></li></ul></div>
						</nav>
			    	</div><!-- #header-right-section -->

			   </div><!-- #header-text-nav-wrap -->
			</div><!-- .inner-wrap -->
		</div><!-- #header-text-nav-container -->

		
						<div class="header-post-title-container clearfix">
					<div class="inner-wrap">
						<div class="post-title-wrapper">
							                                                   <h1 class="header-post-title-class">ettercap学习之内网dns劫持</h1>
                        						   						</div>
											</div>
				</div>
				</header>
			<div id="main" class="clearfix">
		<div class="inner-wrap">
			
	<div id="primary">
		<div id="content" class="clearfix">
						
				
<article id="post-11" class="post-11 post type-post status-publish format-standard hentry category-webshentou">
		<div class="entry-content clearfix">
		<p>这几天看了一个内网渗透视频，试了了一下其中的dns劫持。具体来说就是，此方法可以任意修改它电脑（或手机）的dns，当然可以把中招的电脑的dns可以重定向到自己的ip上（感觉极为适合整蛊，嘿嘿）</p>
<p>使用操作系统：Ubuntu-14.04</p>
<p>首先，安装一下环境</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-56bc6b1647b25425931215" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 21px !important; line-height: 21px !important;"></div>
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-56bc6b1647b25425931215-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-56bc6b1647b25425931215-1"><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-r">get</span><span class="crayon-h"> </span><span class="crayon-e">install </span><span class="crayon-v">ettercap</span><span class="crayon-o">-</span><span class="crayon-v">graphical</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>其次，配置一下本地的apache服务器，然电脑的所有dns都解析到自己的电脑上。</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-56bc6b1647b36725272115" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 21px !important; line-height: 21px !important;"></div>
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-56bc6b1647b36725272115-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-56bc6b1647b36725272115-1"><span class="crayon-e">sudo </span><span class="crayon-r">vim</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-t">var</span><span class="crayon-o">/</span><span class="crayon-v">www</span><span class="crayon-o">/</span><span class="crayon-v">html</span><span class="crayon-o">/</span><span class="crayon-v">index</span><span class="crayon-e">.html</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>按i开始编辑，index.html暂时修改为以下这样：</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-56bc6b1647b3e635923143" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">XHTML</span></div></div>
			<div class="crayon-info" style="min-height: 21px !important; line-height: 21px !important;"></div>
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-56bc6b1647b3e635923143-1">1</div><div class="crayon-num" data-line="crayon-56bc6b1647b3e635923143-2">2</div><div class="crayon-num" data-line="crayon-56bc6b1647b3e635923143-3">3</div><div class="crayon-num" data-line="crayon-56bc6b1647b3e635923143-4">4</div><div class="crayon-num" data-line="crayon-56bc6b1647b3e635923143-5">5</div><div class="crayon-num" data-line="crayon-56bc6b1647b3e635923143-6">6</div><div class="crayon-num" data-line="crayon-56bc6b1647b3e635923143-7">7</div><div class="crayon-num" data-line="crayon-56bc6b1647b3e635923143-8">8</div><div class="crayon-num" data-line="crayon-56bc6b1647b3e635923143-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-56bc6b1647b3e635923143-1"><span class="crayon-n">&lt;!DOCTYPE html&gt;</span></div><div class="crayon-line" id="crayon-56bc6b1647b3e635923143-2"><span class="crayon-r ">&lt;html&gt;</span></div><div class="crayon-line" id="crayon-56bc6b1647b3e635923143-3"><span class="crayon-r ">&lt;head&gt;</span></div><div class="crayon-line" id="crayon-56bc6b1647b3e635923143-4"><span class="crayon-i ">	</span><span class="crayon-r ">&lt;meta </span><span class="crayon-e ">charset</span><span class="crayon-o">=</span><span class="crayon-s ">"utf-8"</span><span class="crayon-r ">/&gt;</span></div><div class="crayon-line" id="crayon-56bc6b1647b3e635923143-5"><span class="crayon-r ">&lt;/head&gt;</span></div><div class="crayon-line" id="crayon-56bc6b1647b3e635923143-6"><span class="crayon-r ">&lt;body&gt;</span></div><div class="crayon-line" id="crayon-56bc6b1647b3e635923143-7"><span class="crayon-i ">	</span><span class="crayon-r ">&lt;h3&gt;</span><span class="crayon-i ">你访问的网站被攻击了。</span><span class="crayon-r ">&lt;/h3&gt;</span></div><div class="crayon-line" id="crayon-56bc6b1647b3e635923143-8"><span class="crayon-r ">&lt;body&gt;</span></div><div class="crayon-line" id="crayon-56bc6b1647b3e635923143-9"><span class="crayon-r ">&lt;/html&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>点击Esc，按下冒号，wq回车，保存退出。访问一下自己电脑上的http://localhost/，如下<a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/1111123232.png"><img class="size-full wp-image-43 aligncenter" src="http://nladuo.github.io/old/wp-content/uploads/2015/12/1111123232.png" alt="1111123232" width="318" height="129" srcset="http://nladuo.github.io/old/wp-content/uploads/2015/12/1111123232-300x122.png 300w, http://nladuo.github.io/old/wp-content/uploads/2015/12/1111123232.png 318w" sizes="(max-width: 318px) 100vw, 318px" /></a><a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/1111123232.png"><br />
</a></p>
<p>接下来开始分别查一下自己的ip还有网关</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-56bc6b1647b46986142246" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 21px !important; line-height: 21px !important;"></div>
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-56bc6b1647b46986142246-1">1</div><div class="crayon-num" data-line="crayon-56bc6b1647b46986142246-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-56bc6b1647b46986142246-1"><span class="crayon-e">ifconfig</span></div><div class="crayon-line" id="crayon-56bc6b1647b46986142246-2"><span class="crayon-v">route</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">n</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>结果如下：</p>
<p><a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/ip.png"><img class="size-full wp-image-44 aligncenter" src="http://nladuo.github.io/old/wp-content/uploads/2015/12/ip.png" alt="ip" width="724" height="199" srcset="http://nladuo.github.io/old/wp-content/uploads/2015/12/ip-300x82.png 300w, http://nladuo.github.io/old/wp-content/uploads/2015/12/ip.png 724w" sizes="(max-width: 724px) 100vw, 724px" /></a></p>
<p><a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/wangguan.png"><img class="size-full wp-image-45 aligncenter" src="http://nladuo.github.io/old/wp-content/uploads/2015/12/wangguan.png" alt="wangguan" width="724" height="157" srcset="http://nladuo.github.io/old/wp-content/uploads/2015/12/wangguan-300x65.png 300w, http://nladuo.github.io/old/wp-content/uploads/2015/12/wangguan.png 724w" sizes="(max-width: 724px) 100vw, 724px" /></a></p>
<p>可以看到本机的ip是10.16.56.130，网关是10.16.56.129。</p>
<p>接下来我们看一下目标测试机，我用的是我的手机，型号为iPhone6s，连上网络之后信息如下：<a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/shoujiip.png"><br />
</a></p>
<p><a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/1202_3.jpg"><img class="wp-image-59 aligncenter" src="http://nladuo.github.io/old/wp-content/uploads/2015/12/1202_3.jpg" alt="1202_3" width="419" height="300" srcset="http://nladuo.github.io/old/wp-content/uploads/2015/12/1202_3-300x215.jpg 300w, http://nladuo.github.io/old/wp-content/uploads/2015/12/1202_3.jpg 750w" sizes="(max-width: 419px) 100vw, 419px" /></a></p>
<p>目标的网关相同，为同一个路由器，目标的ip为10.16.56.133</p>
<p>接下来配置以下dns欺骗的信息：</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-56bc6b1647b4e677663332" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 21px !important; line-height: 21px !important;"></div>
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-56bc6b1647b4e677663332-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-56bc6b1647b4e677663332-1"><span class="crayon-e">sudo </span><span class="crayon-r">vim</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">etc</span><span class="crayon-o">/</span><span class="crayon-v">ettercap</span><span class="crayon-o">/</span><span class="crayon-v">etter</span><span class="crayon-e">.dns</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>在里面添加两行：</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-56bc6b1647b54158193980" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Vim</span></div></div>
			<div class="crayon-info" style="min-height: 21px !important; line-height: 21px !important;"></div>
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-56bc6b1647b54158193980-1">1</div><div class="crayon-num" data-line="crayon-56bc6b1647b54158193980-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-56bc6b1647b54158193980-1"><span class="crayon-o">*</span><span class="crayon-h">		</span><span class="crayon-i">A</span><span class="crayon-h">	</span><span class="crayon-cn">10.16.56.130</span></div><div class="crayon-line" id="crayon-56bc6b1647b54158193980-2"><span class="crayon-o">*</span><span class="crayon-h">		</span><span class="crayon-i">PTR</span><span class="crayon-h">	</span><span class="crayon-cn">10.16.56.130</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>其中*代表任意路由，后面的ip对应的是我自己电脑的ip。退出wq保存之后，就可以开始正式操作了。先输入命令打开ettercap。（注：这里一定要使用超级权限，因为要扫网卡什么的）</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-56bc6b1647b5b784444362" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 15px !important; line-height: 20px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 15px !important;height: 22.5px !important; line-height: 22.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 21px !important; line-height: 21px !important;"></div>
			<div class="crayon-plain-wrap"></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 15px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-56bc6b1647b5b784444362-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 15px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-56bc6b1647b5b784444362-1"><span class="crayon-e">sudo </span><span class="crayon-v">ettercap</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">G</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>打开之后就是这样的。</p>
<p><a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/etter.png"><img class="size-full wp-image-47 aligncenter" src="http://nladuo.github.io/old/wp-content/uploads/2015/12/etter.png" alt="etter" width="1365" height="767" srcset="http://nladuo.github.io/old/wp-content/uploads/2015/12/etter-300x169.png 300w, http://nladuo.github.io/old/wp-content/uploads/2015/12/etter-1024x575.png 1024w, http://nladuo.github.io/old/wp-content/uploads/2015/12/etter.png 1365w" sizes="(max-width: 1365px) 100vw, 1365px" /></a></p>
<p>点击左上角的Unified Sniffing，然后选择网卡（这里如果不用root的方式打开，我在自己的电脑上测试只能扫到蓝牙的），选择wlan0，（如果接网线的话是eth0），然后点击确定之后，再看右上角的菜单就变了，点击Hosts下的hosts list，出现空白的框，然后再点击Hosts下的scan for hosts，就开始扫描了，应该能扫到网卡的ip和目标的ip，这里可以多按几下，多扫几次，扫出来后结果如下：</p>
<p><a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/ipjietu.png"><img class="size-full wp-image-48 aligncenter" src="http://nladuo.github.io/old/wp-content/uploads/2015/12/ipjietu.png" alt="ipjietu" width="629" height="263" srcset="http://nladuo.github.io/old/wp-content/uploads/2015/12/ipjietu-300x125.png 300w, http://nladuo.github.io/old/wp-content/uploads/2015/12/ipjietu.png 629w" sizes="(max-width: 629px) 100vw, 629px" /></a></p>
<p>然后选中网关的ip，点击Add To Target 1，选中目标的ip，点击Add To Target 2。</p>
<p>做完了之后再点击Mitm下面的arp posioning，选中Sniff remote connections，确定。</p>
<p>接着，点击Plugins下面的Manage the plugins，双击dns_spoof后，能看到一个小星号，这样就代表可以了。</p>
<p>Okay，到现在都配置好了，点击Start下面的start sniffing之后，就起作用了，我们点开手机看看。</p>
<p>先打开百度，是这样的：<a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/baidu.png"><br />
</a></p>
<p><a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/1202_1.jpg"><img class="wp-image-60 aligncenter" src="http://nladuo.github.io/old/wp-content/uploads/2015/12/1202_1.jpg" alt="1202_1" width="480" height="323" srcset="http://nladuo.github.io/old/wp-content/uploads/2015/12/1202_1-300x202.jpg 300w, http://nladuo.github.io/old/wp-content/uploads/2015/12/1202_1.jpg 750w" sizes="(max-width: 480px) 100vw, 480px" /></a></p>
<p>再看看微博，还是这样的：<a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/etter-weibo.png"><br />
</a></p>
<p><a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/1202_2.jpg"><img class="wp-image-61 aligncenter" src="http://nladuo.github.io/old/wp-content/uploads/2015/12/1202_2.jpg" alt="1202_2" width="481" height="282" srcset="http://nladuo.github.io/old/wp-content/uploads/2015/12/1202_2-300x176.jpg 300w, http://nladuo.github.io/old/wp-content/uploads/2015/12/1202_2.jpg 750w" sizes="(max-width: 481px) 100vw, 481px" /></a></p>
<p>我们看看ettercap日志，</p>
<p><a href="http://nladuo.github.io/old/wp-content/uploads/2015/12/spoof.png"><img class="size-full wp-image-51 aligncenter" src="http://nladuo.github.io/old/wp-content/uploads/2015/12/spoof.png" alt="spoof" width="644" height="169" srcset="http://nladuo.github.io/old/wp-content/uploads/2015/12/spoof-300x79.png 300w, http://nladuo.github.io/old/wp-content/uploads/2015/12/spoof-642x169.png 642w, http://nladuo.github.io/old/wp-content/uploads/2015/12/spoof.png 644w" sizes="(max-width: 644px) 100vw, 644px" /></a></p>
<p>发现目标机子中请求的dns都被重定向到本机的ip上了。至此，大功告成了。</p>
<div class="extra-hatom-entry-title"><span class="entry-title">ettercap学习之内网dns劫持</span></div>	</div>

	<footer class="entry-meta-bar clearfix"><div class="entry-meta clearfix">
      <span class="by-author author vcard"><a class="url fn n" href="http://nladuo.github.io/old/index.php/author/root/">叁公子</a></span>

      <span class="date"><a href="http://nladuo.github.io/old/index.php/2015/12/02/ettercap-dns/" title="上午1:40" rel="bookmark"><time class="entry-date published" datetime="2015-12-02T01:40:49+00:00">2015年12月2日</time><time class="updated" datetime="2015-12-02T10:53:21+00:00">2015年12月2日</time></a></span>
               <span class="category"><a href="http://nladuo.github.io/old/index.php/category/webshentou/" rel="category tag">web渗透</a></span>
      
               <span class="comments"><a href="http://nladuo.github.io/old/index.php/2015/12/02/ettercap-dns/#respond">No Comments</a></span>
      
      
      
      </div></footer>
	</article>
				
		<ul class="default-wp-page clearfix">
			<li class="previous"><a href="http://nladuo.github.io/old/index.php/2015/11/10/monidenglu/" rel="prev"><span class="meta-nav">&larr;</span> go语言实现模拟登陆极客学院</a></li>
			<li class="next"><a href="http://nladuo.github.io/old/index.php/2015/12/09/diy-pm2-5/" rel="next">教你DIY一个PM2.5检测仪 <span class="meta-nav">&rarr;</span></a></li>
		</ul>
	
				
<div id="comments" class="comments-area">

	
	
	
					<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/2015/12/02/ettercap-dns/#respond" style="display:none;">取消回复</a></small></h3>				<form action="http://nladuo.github.io/old/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>
					<p class="comment-notes"><span id="email-notes">电子邮件地址不会被公开。</span> 必填项已用<span class="required">*</span>标注</p><p class="comment-form-comment"><label for="comment">评论</label> <textarea id="comment" name="comment" cols="45" rows="8"  aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">姓名 <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">电子邮件 <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">站点</label> <input id="url" name="url" type="url" value="" size="30" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="发表评论" /> <input type='hidden' name='comment_post_ID' value='11' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p>				</form>
					</div><!-- #respond -->
		
</div><!-- #comments -->
			
		</div><!-- #content -->
	</div><!-- #primary -->
	
	
<div id="secondary">
			
		<aside id="search-2" class="widget widget_search"><form action="http://nladuo.github.io/old/" class="search-form searchform clearfix" method="get">
	<div class="search-wrap">
		<input type="text" placeholder="Search" class="s field" name="s">
		<button class="search-icon" type="submit"></button>
	</div>
</form><!-- .searchform --></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widget-title"><span>近期文章</span></h3>		<ul>
					<li>
				<a href="http://nladuo.github.io/old/index.php/2016/02/11/express-session/">Express实现登陆验证</a>
						</li>
					<li>
				<a href="http://nladuo.github.io/old/index.php/2016/02/10/node-messageboard/">Express+Sequelize写一个简单的留言板</a>
						</li>
					<li>
				<a href="http://nladuo.github.io/old/index.php/2015/12/09/diy-pm2-5/">教你DIY一个PM2.5检测仪</a>
						</li>
					<li>
				<a href="http://nladuo.github.io/old/index.php/2015/12/02/ettercap-dns/">ettercap学习之内网dns劫持</a>
						</li>
					<li>
				<a href="http://nladuo.github.io/old/index.php/2015/11/10/monidenglu/">go语言实现模拟登陆极客学院</a>
						</li>
				</ul>
		</aside>		<aside id="recent-comments-2" class="widget widget_recent_comments"><h3 class="widget-title"><span>近期评论</span></h3><ul id="recentcomments"></ul></aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title"><span>文章归档</span></h3>		<ul>
			<li><a href='http://nladuo.github.io/old/index.php/2016/02/'>2016年二月</a></li>
	<li><a href='http://nladuo.github.io/old/index.php/2015/12/'>2015年十二月</a></li>
	<li><a href='http://nladuo.github.io/old/index.php/2015/11/'>2015年十一月</a></li>
	<li><a href='http://nladuo.github.io/old/index.php/2015/05/'>2015年五月</a></li>
	<li><a href='http://nladuo.github.io/old/index.php/2012/12/'>2012年十二月</a></li>
		</ul>
		</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title"><span>分类目录</span></h3>		<ul>
	<li class="cat-item cat-item-4"><a href="http://nladuo.github.io/old/index.php/category/net/" >.Net</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://nladuo.github.io/old/index.php/category/golang/" >Golang</a>
</li>
	<li class="cat-item cat-item-10"><a href="http://nladuo.github.io/old/index.php/category/nodejs/" >NodeJs</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://nladuo.github.io/old/index.php/category/webshentou/" >web渗透</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://nladuo.github.io/old/index.php/category/embedded-system/" >嵌入式</a>
</li>
	<li class="cat-item cat-item-2"><a href="http://nladuo.github.io/old/index.php/category/sanwen/" >散文随笔</a>
</li>
	<li class="cat-item cat-item-9"><a href="http://nladuo.github.io/old/index.php/category/iot/" >物联网</a>
</li>
	<li class="cat-item cat-item-11"><a href="http://nladuo.github.io/old/index.php/category/web-crawler/" >网络爬虫</a>
</li>
		</ul>
</aside>	</div>	
	

		</div><!-- .inner-wrap -->
	</div><!-- #main -->	
			<footer id="colophon" class="clearfix">	
			
	
			<div class="footer-socket-wrapper clearfix">
				<div class="inner-wrap">
					<div class="footer-socket-area">
						<div class="copyright">Copyright &copy; 2016 <a href="http://nladuo.github.io/old/" title="叁公子的博客" ><span>叁公子的博客</span></a>. Powered by <a href="http://wordpress.org" target="_blank" title="WordPress"><span>WordPress</span></a>. Theme: Spacious by <a href="http://themegrill.com/themes/spacious" target="_blank" title="ThemeGrill" rel="designer"><span>ThemeGrill</span></a>.</div>						<nav class="small-menu clearfix">
									    			</nav>
					</div>
				</div>
			</div>			
		</footer>
		<a href="#masthead" id="scroll-up"></a>	
	</div><!-- #page -->
	<script type='text/javascript' src='http://nladuo.github.io/old/wp-includes/js/comment-reply.min.js?ver=4.4.2'></script>
<script type='text/javascript' src='http://nladuo.github.io/old/wp-content/themes/spacious/js/navigation.js?ver=4.4.2'></script>
<script type='text/javascript' src='http://nladuo.github.io/old/wp-includes/js/wp-embed.min.js?ver=4.4.2'></script>
</body>
</html>